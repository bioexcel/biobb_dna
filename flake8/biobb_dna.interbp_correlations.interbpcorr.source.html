<!DOCTYPE html>
<html>
   <head>
      <title>biobb_dna/interbp_correlations/interbpcorr.py - flake8 annotated source</title>
      <meta http-equiv="Content-Type" value="text/html; charset=UTF-8">
      <link rel="stylesheet" href="styles.css">
   </head>
   <body>
      <div id="masthead" class="sev-2"></div>
      <div id="page">
         <h1>
            <a href="biobb_dna.interbp_correlations.interbpcorr.report.html">
               <img src="back.svg" alt="&#x2B05;">
               biobb_dna/interbp_correlations/interbpcorr.py source
            </a>
         </h1>

         <div id="doc">
            <div id="l1"
               class="code sev- "><tt><i>1</i> <span class="ch">#!/usr/bin/env python3</span></tt>
            </div>
            <div id="l2"
               class="code sev- "><tt><i>2</i> &nbsp;</tt>
            </div>
            <div id="l3"
               class="code sev- "><tt><i>3</i> <span class="sd">&quot;&quot;&quot;Module containing the InterBasePairCorrelation class and the command line interface.&quot;&quot;&quot;</span></tt>
            </div>
            <div id="l4"
               class="code sev- "><tt><i>4</i> &nbsp;</tt>
            </div>
            <div id="l5"
               class="code sev- "><tt><i>5</i> <span class="kn">import</span> <span class="nn">argparse</span></tt>
            </div>
            <div id="l6"
               class="code sev- "><tt><i>6</i> <span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span></tt>
            </div>
            <div id="l7"
               class="code sev- "><tt><i>7</i> <span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span></tt>
            </div>
            <div id="l8"
               class="code sev- "><tt><i>8</i> &nbsp;</tt>
            </div>
            <div id="l9"
               class="code sev- "><tt><i>9</i> <span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span></tt>
            </div>
            <div id="l10"
               class="code sev- "><tt><i>10</i> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span></tt>
            </div>
            <div id="l11"
               class="code sev- "><tt><i>11</i> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></tt>
            </div>
            <div id="l12"
               class="code sev- "><tt><i>12</i> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span></tt>
            </div>
            <div id="l13"
               class="code sev- "><tt><i>13</i> <span class="kn">from</span> <span class="nn">biobb_common.configuration</span> <span class="kn">import</span> <span class="n">settings</span></tt>
            </div>
            <div id="l14"
               class="code sev- "><tt><i>14</i> <span class="kn">from</span> <span class="nn">biobb_common.generic.biobb_object</span> <span class="kn">import</span> <span class="n">BiobbObject</span></tt>
            </div>
            <div id="l15"
               class="code sev- "><tt><i>15</i> <span class="kn">from</span> <span class="nn">biobb_common.tools.file_utils</span> <span class="kn">import</span> <span class="n">launchlogger</span></tt>
            </div>
            <div id="l16"
               class="code sev- "><tt><i>16</i> &nbsp;</tt>
            </div>
            <div id="l17"
               class="code sev- "><tt><i>17</i> <span class="kn">from</span> <span class="nn">biobb_dna.utils</span> <span class="kn">import</span> <span class="n">constants</span></tt>
            </div>
            <div id="l18"
               class="code sev- "><tt><i>18</i> <span class="kn">from</span> <span class="nn">biobb_dna.utils.common</span> <span class="kn">import</span> <span class="n">_from_string_to_list</span></tt>
            </div>
            <div id="l19"
               class="code sev- "><tt><i>19</i> <span class="kn">from</span> <span class="nn">biobb_dna.utils.loader</span> <span class="kn">import</span> <span class="n">read_series</span></tt>
            </div>
            <div id="l20"
               class="code sev- "><tt><i>20</i> &nbsp;</tt>
            </div>
            <div id="l21"
               class="code sev- "><tt><i>21</i> &nbsp;</tt>
            </div>
            <div id="l22"
               class="code sev- "><tt><i>22</i> <span class="k">class</span> <span class="nc">InterBasePairCorrelation</span><span class="p">(</span><span class="n">BiobbObject</span><span class="p">):</span></tt>
            </div>
            <div id="l23"
               class="code sev- "><tt><i>23</i> <span class="w">    </span><span class="sd">&quot;&quot;&quot;</span></tt>
            </div>
            <div id="l24"
               class="code sev- "><tt><i>24</i> <span class="sd">    | biobb_dna InterBasePairCorrelation</span></tt>
            </div>
            <div id="l25"
               class="code sev- "><tt><i>25</i> <span class="sd">    | Calculate correlation between all base pairs of a single sequence and for a single helical parameter.</span></tt>
            </div>
            <div id="l26"
               class="code sev- "><tt><i>26</i> <span class="sd">    | Calculate correlation between neighboring base pairs and pairs of helical parameters.</span></tt>
            </div>
            <div id="l27"
               class="code sev- "><tt><i>27</i> &nbsp;</tt>
            </div>
            <div id="l28"
               class="code sev- "><tt><i>28</i> <span class="sd">    Args:</span></tt>
            </div>
            <div id="l29"
               class="code sev- "><tt><i>29</i> <span class="sd">        input_filename_shift (str): Path to .ser file with data for helical parameter &#39;shift&#39;. File type: input. `Sample file &lt;https://raw.githubusercontent.com/bioexcel/biobb_dna/master/biobb_dna/test/data/correlation/canal_output_shift.ser&gt;`_. Accepted formats: ser (edam:format_2330).</span></tt>
            </div>
            <div id="l30"
               class="code sev- "><tt><i>30</i> <span class="sd">        input_filename_slide (str): Path to .ser file with data for helical parameter &#39;slide&#39;. File type: input. `Sample file &lt;https://raw.githubusercontent.com/bioexcel/biobb_dna/master/biobb_dna/test/data/correlation/canal_output_slide.ser&gt;`_. Accepted formats: ser (edam:format_2330).</span></tt>
            </div>
            <div id="l31"
               class="code sev- "><tt><i>31</i> <span class="sd">        input_filename_rise (str): Path to .ser file with data for helical parameter &#39;rise&#39;. File type: input. `Sample file &lt;https://raw.githubusercontent.com/bioexcel/biobb_dna/master/biobb_dna/test/data/correlation/canal_output_rise.ser&gt;`_. Accepted formats: ser (edam:format_2330).</span></tt>
            </div>
            <div id="l32"
               class="code sev- "><tt><i>32</i> <span class="sd">        input_filename_tilt (str): Path to .ser file with data for helical parameter &#39;tilt&#39;. File type: input. `Sample file &lt;https://raw.githubusercontent.com/bioexcel/biobb_dna/master/biobb_dna/test/data/correlation/canal_output_tilt.ser&gt;`_. Accepted formats: ser (edam:format_2330).</span></tt>
            </div>
            <div id="l33"
               class="code sev- "><tt><i>33</i> <span class="sd">        input_filename_roll (str): Path to .ser file with data for helical parameter &#39;roll&#39;. File type: input. `Sample file &lt;https://raw.githubusercontent.com/bioexcel/biobb_dna/master/biobb_dna/test/data/correlation/canal_output_roll.ser&gt;`_. Accepted formats: ser (edam:format_2330).</span></tt>
            </div>
            <div id="l34"
               class="code sev- "><tt><i>34</i> <span class="sd">        input_filename_twist (str): Path to .ser file with data for helical parameter &#39;twist&#39;. File type: input. `Sample file &lt;https://raw.githubusercontent.com/bioexcel/biobb_dna/master/biobb_dna/test/data/correlation/canal_output_twist.ser&gt;`_. Accepted formats: ser (edam:format_2330).</span></tt>
            </div>
            <div id="l35"
               class="code sev- "><tt><i>35</i> <span class="sd">        output_csv_path (str): Path to directory where output is saved. File type: output. `Sample file &lt;https://raw.githubusercontent.com/bioexcel/biobb_dna/master/biobb_dna/test/reference/correlation/inter_bpcorr_ref.csv&gt;`_. Accepted formats: csv (edam:format_3752).</span></tt>
            </div>
            <div id="l36"
               class="code sev- "><tt><i>36</i> <span class="sd">        output_jpg_path (str): Path to .jpg file where output is saved. File type: output. `Sample file &lt;https://raw.githubusercontent.com/bioexcel/biobb_dna/master/biobb_dna/test/reference/correlation/inter_bpcorr_ref.jpg&gt;`_. Accepted formats: jpg (edam:format_3579).</span></tt>
            </div>
            <div id="l37"
               class="code sev- "><tt><i>37</i> <span class="sd">        properties (dict):</span></tt>
            </div>
            <div id="l38"
               class="code sev- "><tt><i>38</i> <span class="sd">            * **sequence** (*str*) - (None) Nucleic acid sequence for the input .ser file. Length of sequence is expected to be the same as the total number of columns in the .ser file, minus the index column (even if later on a subset of columns is selected with the *seqpos* option).</span></tt>
            </div>
            <div id="l39"
               class="code sev- "><tt><i>39</i> <span class="sd">            * **seqpos** (*list*) - (None) list of sequence positions (columns indices starting by 0) to analyze.  If not specified it will analyse the complete sequence.</span></tt>
            </div>
            <div id="l40"
               class="code sev- "><tt><i>40</i> <span class="sd">            * **remove_tmp** (*bool*) - (True) [WF property] Remove temporal files.</span></tt>
            </div>
            <div id="l41"
               class="code sev- "><tt><i>41</i> <span class="sd">            * **restart** (*bool*) - (False) [WF property] Do not execute if output files exist.</span></tt>
            </div>
            <div id="l42"
               class="code sev- "><tt><i>42</i> <span class="sd">            * **sandbox_path** (*str*) - (&quot;./&quot;) [WF property] Parent path to the sandbox directory.</span></tt>
            </div>
            <div id="l43"
               class="code sev- "><tt><i>43</i> &nbsp;</tt>
            </div>
            <div id="l44"
               class="code sev- "><tt><i>44</i> <span class="sd">    Examples:</span></tt>
            </div>
            <div id="l45"
               class="code sev- "><tt><i>45</i> <span class="sd">        This is a use example of how to use the building block from Python::</span></tt>
            </div>
            <div id="l46"
               class="code sev- "><tt><i>46</i> &nbsp;</tt>
            </div>
            <div id="l47"
               class="code sev- "><tt><i>47</i> <span class="sd">            from biobb_dna.interbp_correlations.interbpcorr import interbpcorr</span></tt>
            </div>
            <div id="l48"
               class="code sev- "><tt><i>48</i> &nbsp;</tt>
            </div>
            <div id="l49"
               class="code sev- "><tt><i>49</i> <span class="sd">            interbpcorr(</span></tt>
            </div>
            <div id="l50"
               class="code sev- "><tt><i>50</i> <span class="sd">                input_filename_shift=&#39;path/to/input/shift.ser&#39;,</span></tt>
            </div>
            <div id="l51"
               class="code sev- "><tt><i>51</i> <span class="sd">                input_filename_slide=&#39;path/to/input/slide.ser&#39;,</span></tt>
            </div>
            <div id="l52"
               class="code sev- "><tt><i>52</i> <span class="sd">                input_filename_rise=&#39;path/to/input/slide.ser&#39;,</span></tt>
            </div>
            <div id="l53"
               class="code sev- "><tt><i>53</i> <span class="sd">                input_filename_tilt=&#39;path/to/input/tilt.ser&#39;,</span></tt>
            </div>
            <div id="l54"
               class="code sev- "><tt><i>54</i> <span class="sd">                input_filename_roll=&#39;path/to/input/roll.ser&#39;,</span></tt>
            </div>
            <div id="l55"
               class="code sev- "><tt><i>55</i> <span class="sd">                input_filename_twist=&#39;path/to/input/twist.ser&#39;,</span></tt>
            </div>
            <div id="l56"
               class="code sev- "><tt><i>56</i> <span class="sd">                output_csv_path=&#39;path/to/output/file.csv&#39;,</span></tt>
            </div>
            <div id="l57"
               class="code sev- "><tt><i>57</i> <span class="sd">                output_jpg_path=&#39;path/to/output/plot.jpg&#39;,</span></tt>
            </div>
            <div id="l58"
               class="code sev- "><tt><i>58</i> <span class="sd">                properties=prop)</span></tt>
            </div>
            <div id="l59"
               class="code sev- "><tt><i>59</i> <span class="sd">    Info:</span></tt>
            </div>
            <div id="l60"
               class="code sev- "><tt><i>60</i> <span class="sd">        * wrapped_software:</span></tt>
            </div>
            <div id="l61"
               class="code sev- "><tt><i>61</i> <span class="sd">            * name: In house</span></tt>
            </div>
            <div id="l62"
               class="code sev- "><tt><i>62</i> <span class="sd">            * license: Apache-2.0</span></tt>
            </div>
            <div id="l63"
               class="code sev- "><tt><i>63</i> <span class="sd">        * ontology:</span></tt>
            </div>
            <div id="l64"
               class="code sev- "><tt><i>64</i> <span class="sd">            * name: EDAM</span></tt>
            </div>
            <div id="l65"
               class="code sev- "><tt><i>65</i> <span class="sd">            * schema: http://edamontology.org/EDAM.owl</span></tt>
            </div>
            <div id="l66"
               class="code sev- "><tt><i>66</i> &nbsp;</tt>
            </div>
            <div id="l67"
               class="code sev- "><tt><i>67</i> <span class="sd">    &quot;&quot;&quot;</span></tt>
            </div>
            <div id="l68"
               class="code sev- "><tt><i>68</i> &nbsp;</tt>
            </div>
            <div id="l69"
               class="code sev- "><tt><i>69</i>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span></tt>
            </div>
            <div id="l70"
               class="code sev- "><tt><i>70</i>         <span class="bp">self</span><span class="p">,</span></tt>
            </div>
            <div id="l71"
               class="code sev- "><tt><i>71</i>         <span class="n">input_filename_shift</span><span class="p">,</span></tt>
            </div>
            <div id="l72"
               class="code sev- "><tt><i>72</i>         <span class="n">input_filename_slide</span><span class="p">,</span></tt>
            </div>
            <div id="l73"
               class="code sev- "><tt><i>73</i>         <span class="n">input_filename_rise</span><span class="p">,</span></tt>
            </div>
            <div id="l74"
               class="code sev- "><tt><i>74</i>         <span class="n">input_filename_tilt</span><span class="p">,</span></tt>
            </div>
            <div id="l75"
               class="code sev- "><tt><i>75</i>         <span class="n">input_filename_roll</span><span class="p">,</span></tt>
            </div>
            <div id="l76"
               class="code sev- "><tt><i>76</i>         <span class="n">input_filename_twist</span><span class="p">,</span></tt>
            </div>
            <div id="l77"
               class="code sev- "><tt><i>77</i>         <span class="n">output_csv_path</span><span class="p">,</span></tt>
            </div>
            <div id="l78"
               class="code sev- "><tt><i>78</i>         <span class="n">output_jpg_path</span><span class="p">,</span></tt>
            </div>
            <div id="l79"
               class="code sev- "><tt><i>79</i>         <span class="n">properties</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></tt>
            </div>
            <div id="l80"
               class="code sev- "><tt><i>80</i>         <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span></tt>
            </div>
            <div id="l81"
               class="code sev- "><tt><i>81</i>     <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span></tt>
            </div>
            <div id="l82"
               class="code sev- "><tt><i>82</i>         <span class="n">properties</span> <span class="o">=</span> <span class="n">properties</span> <span class="ow">or</span> <span class="p">{}</span></tt>
            </div>
            <div id="l83"
               class="code sev- "><tt><i>83</i> &nbsp;</tt>
            </div>
            <div id="l84"
               class="code sev- "><tt><i>84</i>         <span class="c1"># Call parent class constructor</span></tt>
            </div>
            <div id="l85"
               class="code sev- "><tt><i>85</i>         <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">properties</span><span class="p">)</span></tt>
            </div>
            <div id="l86"
               class="code sev- "><tt><i>86</i>         <span class="bp">self</span><span class="o">.</span><span class="n">locals_var_dict</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></tt>
            </div>
            <div id="l87"
               class="code sev- "><tt><i>87</i> &nbsp;</tt>
            </div>
            <div id="l88"
               class="code sev- "><tt><i>88</i>         <span class="c1"># Input/Output files</span></tt>
            </div>
            <div id="l89"
               class="code sev- "><tt><i>89</i>         <span class="bp">self</span><span class="o">.</span><span class="n">io_dict</span> <span class="o">=</span> <span class="p">{</span></tt>
            </div>
            <div id="l90"
               class="code sev- "><tt><i>90</i>             <span class="s2">&quot;in&quot;</span><span class="p">:</span> <span class="p">{</span></tt>
            </div>
            <div id="l91"
               class="code sev- "><tt><i>91</i>                 <span class="s2">&quot;input_filename_shift&quot;</span><span class="p">:</span> <span class="n">input_filename_shift</span><span class="p">,</span></tt>
            </div>
            <div id="l92"
               class="code sev- "><tt><i>92</i>                 <span class="s2">&quot;input_filename_slide&quot;</span><span class="p">:</span> <span class="n">input_filename_slide</span><span class="p">,</span></tt>
            </div>
            <div id="l93"
               class="code sev- "><tt><i>93</i>                 <span class="s2">&quot;input_filename_rise&quot;</span><span class="p">:</span> <span class="n">input_filename_rise</span><span class="p">,</span></tt>
            </div>
            <div id="l94"
               class="code sev- "><tt><i>94</i>                 <span class="s2">&quot;input_filename_tilt&quot;</span><span class="p">:</span> <span class="n">input_filename_tilt</span><span class="p">,</span></tt>
            </div>
            <div id="l95"
               class="code sev- "><tt><i>95</i>                 <span class="s2">&quot;input_filename_roll&quot;</span><span class="p">:</span> <span class="n">input_filename_roll</span><span class="p">,</span></tt>
            </div>
            <div id="l96"
               class="code sev- "><tt><i>96</i>                 <span class="s2">&quot;input_filename_twist&quot;</span><span class="p">:</span> <span class="n">input_filename_twist</span><span class="p">,</span></tt>
            </div>
            <div id="l97"
               class="code sev- "><tt><i>97</i>             <span class="p">},</span></tt>
            </div>
            <div id="l98"
               class="code sev- "><tt><i>98</i>             <span class="s2">&quot;out&quot;</span><span class="p">:</span> <span class="p">{</span></tt>
            </div>
            <div id="l99"
               class="code sev- "><tt><i>99</i>                 <span class="s2">&quot;output_csv_path&quot;</span><span class="p">:</span> <span class="n">output_csv_path</span><span class="p">,</span></tt>
            </div>
            <div id="l100"
               class="code sev- "><tt><i>100</i>                 <span class="s2">&quot;output_jpg_path&quot;</span><span class="p">:</span> <span class="n">output_jpg_path</span><span class="p">,</span></tt>
            </div>
            <div id="l101"
               class="code sev- "><tt><i>101</i>             <span class="p">},</span></tt>
            </div>
            <div id="l102"
               class="code sev- "><tt><i>102</i>         <span class="p">}</span></tt>
            </div>
            <div id="l103"
               class="code sev- "><tt><i>103</i> &nbsp;</tt>
            </div>
            <div id="l104"
               class="code sev- "><tt><i>104</i>         <span class="bp">self</span><span class="o">.</span><span class="n">properties</span> <span class="o">=</span> <span class="n">properties</span></tt>
            </div>
            <div id="l105"
               class="code sev- "><tt><i>105</i>         <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">=</span> <span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sequence&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span></tt>
            </div>
            <div id="l106"
               class="code sev- "><tt><i>106</i>         <span class="bp">self</span><span class="o">.</span><span class="n">seqpos</span> <span class="o">=</span> <span class="p">[</span></tt>
            </div>
            <div id="l107"
               class="code sev- "><tt><i>107</i>             <span class="nb">int</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">_from_string_to_list</span><span class="p">(</span><span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;seqpos&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span></tt>
            </div>
            <div id="l108"
               class="code sev- "><tt><i>108</i>         <span class="p">]</span></tt>
            </div>
            <div id="l109"
               class="code sev- "><tt><i>109</i> &nbsp;</tt>
            </div>
            <div id="l110"
               class="code sev- "><tt><i>110</i>         <span class="c1"># Check the properties</span></tt>
            </div>
            <div id="l111"
               class="code sev- "><tt><i>111</i>         <span class="bp">self</span><span class="o">.</span><span class="n">check_properties</span><span class="p">(</span><span class="n">properties</span><span class="p">)</span></tt>
            </div>
            <div id="l112"
               class="code sev- "><tt><i>112</i>         <span class="bp">self</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">()</span></tt>
            </div>
            <div id="l113"
               class="code sev- "><tt><i>113</i> &nbsp;</tt>
            </div>
            <div id="l114"
               class="code sev- "><tt><i>114</i>     <span class="nd">@launchlogger</span></tt>
            </div>
            <div id="l115"
               class="code sev- "><tt><i>115</i>     <span class="k">def</span> <span class="nf">launch</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span></tt>
            </div>
            <div id="l116"
               class="code sev- "><tt><i>116</i> <span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute the :class:`HelParCorrelation &lt;correlations.interbpcorr.InterBasePairCorrelation&gt;` object.&quot;&quot;&quot;</span></tt>
            </div>
            <div id="l117"
               class="code sev- "><tt><i>117</i> &nbsp;</tt>
            </div>
            <div id="l118"
               class="code sev- "><tt><i>118</i>         <span class="c1"># Setup Biobb</span></tt>
            </div>
            <div id="l119"
               class="code sev- "><tt><i>119</i>         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_restart</span><span class="p">():</span></tt>
            </div>
            <div id="l120"
               class="code sev- "><tt><i>120</i>             <span class="k">return</span> <span class="mi">0</span></tt>
            </div>
            <div id="l121"
               class="code sev- "><tt><i>121</i>         <span class="bp">self</span><span class="o">.</span><span class="n">stage_files</span><span class="p">()</span></tt>
            </div>
            <div id="l122"
               class="code sev- "><tt><i>122</i> &nbsp;</tt>
            </div>
            <div id="l123"
               class="code sev- "><tt><i>123</i>         <span class="c1"># check sequence</span></tt>
            </div>
            <div id="l124"
               class="code sev- "><tt><i>124</i>         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sequence</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span></tt>
            </div>
            <div id="l125"
               class="code sev- "><tt><i>125</i>             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;sequence is null or too short!&quot;</span><span class="p">)</span></tt>
            </div>
            <div id="l126"
               class="code sev- "><tt><i>126</i> &nbsp;</tt>
            </div>
            <div id="l127"
               class="code sev- "><tt><i>127</i>         <span class="c1"># check seqpos</span></tt>
            </div>
            <div id="l128"
               class="code sev- "><tt><i>128</i>         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">seqpos</span><span class="p">:</span></tt>
            </div>
            <div id="l129"
               class="code sev- "><tt><i>129</i>             <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqpos</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqpos</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span></tt>
            </div>
            <div id="l130"
               class="code sev- "><tt><i>130</i>                 <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;seqpos must be a list of at least two integers&quot;</span><span class="p">)</span></tt>
            </div>
            <div id="l131"
               class="code sev- "><tt><i>131</i>         <span class="k">else</span><span class="p">:</span></tt>
            </div>
            <div id="l132"
               class="code sev- "><tt><i>132</i>             <span class="bp">self</span><span class="o">.</span><span class="n">seqpos</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># type: ignore</span></tt>
            </div>
            <div id="l133"
               class="code sev- "><tt><i>133</i> &nbsp;</tt>
            </div>
            <div id="l134"
               class="code sev- "><tt><i>134</i>         <span class="c1"># read input</span></tt>
            </div>
            <div id="l135"
               class="code sev- "><tt><i>135</i>         <span class="n">shift</span> <span class="o">=</span> <span class="n">read_series</span><span class="p">(</span></tt>
            </div>
            <div id="l136"
               class="code sev- "><tt><i>136</i>             <span class="bp">self</span><span class="o">.</span><span class="n">stage_io_dict</span><span class="p">[</span><span class="s2">&quot;in&quot;</span><span class="p">][</span><span class="s2">&quot;input_filename_shift&quot;</span><span class="p">],</span> <span class="n">usecols</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seqpos</span></tt>
            </div>
            <div id="l137"
               class="code sev- "><tt><i>137</i>         <span class="p">)</span></tt>
            </div>
            <div id="l138"
               class="code sev- "><tt><i>138</i>         <span class="n">slide</span> <span class="o">=</span> <span class="n">read_series</span><span class="p">(</span></tt>
            </div>
            <div id="l139"
               class="code sev- "><tt><i>139</i>             <span class="bp">self</span><span class="o">.</span><span class="n">stage_io_dict</span><span class="p">[</span><span class="s2">&quot;in&quot;</span><span class="p">][</span><span class="s2">&quot;input_filename_slide&quot;</span><span class="p">],</span> <span class="n">usecols</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seqpos</span></tt>
            </div>
            <div id="l140"
               class="code sev- "><tt><i>140</i>         <span class="p">)</span></tt>
            </div>
            <div id="l141"
               class="code sev- "><tt><i>141</i>         <span class="n">rise</span> <span class="o">=</span> <span class="n">read_series</span><span class="p">(</span></tt>
            </div>
            <div id="l142"
               class="code sev- "><tt><i>142</i>             <span class="bp">self</span><span class="o">.</span><span class="n">stage_io_dict</span><span class="p">[</span><span class="s2">&quot;in&quot;</span><span class="p">][</span><span class="s2">&quot;input_filename_rise&quot;</span><span class="p">],</span> <span class="n">usecols</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seqpos</span></tt>
            </div>
            <div id="l143"
               class="code sev- "><tt><i>143</i>         <span class="p">)</span></tt>
            </div>
            <div id="l144"
               class="code sev- "><tt><i>144</i>         <span class="n">tilt</span> <span class="o">=</span> <span class="n">read_series</span><span class="p">(</span></tt>
            </div>
            <div id="l145"
               class="code sev- "><tt><i>145</i>             <span class="bp">self</span><span class="o">.</span><span class="n">stage_io_dict</span><span class="p">[</span><span class="s2">&quot;in&quot;</span><span class="p">][</span><span class="s2">&quot;input_filename_tilt&quot;</span><span class="p">],</span> <span class="n">usecols</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seqpos</span></tt>
            </div>
            <div id="l146"
               class="code sev- "><tt><i>146</i>         <span class="p">)</span></tt>
            </div>
            <div id="l147"
               class="code sev- "><tt><i>147</i>         <span class="n">roll</span> <span class="o">=</span> <span class="n">read_series</span><span class="p">(</span></tt>
            </div>
            <div id="l148"
               class="code sev- "><tt><i>148</i>             <span class="bp">self</span><span class="o">.</span><span class="n">stage_io_dict</span><span class="p">[</span><span class="s2">&quot;in&quot;</span><span class="p">][</span><span class="s2">&quot;input_filename_roll&quot;</span><span class="p">],</span> <span class="n">usecols</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seqpos</span></tt>
            </div>
            <div id="l149"
               class="code sev- "><tt><i>149</i>         <span class="p">)</span></tt>
            </div>
            <div id="l150"
               class="code sev- "><tt><i>150</i>         <span class="n">twist</span> <span class="o">=</span> <span class="n">read_series</span><span class="p">(</span></tt>
            </div>
            <div id="l151"
               class="code sev- "><tt><i>151</i>             <span class="bp">self</span><span class="o">.</span><span class="n">stage_io_dict</span><span class="p">[</span><span class="s2">&quot;in&quot;</span><span class="p">][</span><span class="s2">&quot;input_filename_twist&quot;</span><span class="p">],</span> <span class="n">usecols</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seqpos</span></tt>
            </div>
            <div id="l152"
               class="code sev- "><tt><i>152</i>         <span class="p">)</span></tt>
            </div>
            <div id="l153"
               class="code sev- "><tt><i>153</i> &nbsp;</tt>
            </div>
            <div id="l154"
               class="code sev- "><tt><i>154</i>         <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">seqpos</span><span class="p">:</span></tt>
            </div>
            <div id="l155"
               class="code sev- "><tt><i>155</i>             <span class="c1"># drop first and last columns</span></tt>
            </div>
            <div id="l156"
               class="code sev- "><tt><i>156</i>             <span class="n">shift</span> <span class="o">=</span> <span class="n">shift</span><span class="p">[</span><span class="n">shift</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]]</span></tt>
            </div>
            <div id="l157"
               class="code sev- "><tt><i>157</i>             <span class="n">slide</span> <span class="o">=</span> <span class="n">slide</span><span class="p">[</span><span class="n">slide</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]]</span></tt>
            </div>
            <div id="l158"
               class="code sev- "><tt><i>158</i>             <span class="n">rise</span> <span class="o">=</span> <span class="n">rise</span><span class="p">[</span><span class="n">rise</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]]</span></tt>
            </div>
            <div id="l159"
               class="code sev- "><tt><i>159</i>             <span class="n">tilt</span> <span class="o">=</span> <span class="n">tilt</span><span class="p">[</span><span class="n">tilt</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]]</span></tt>
            </div>
            <div id="l160"
               class="code sev- "><tt><i>160</i>             <span class="n">roll</span> <span class="o">=</span> <span class="n">roll</span><span class="p">[</span><span class="n">roll</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]]</span></tt>
            </div>
            <div id="l161"
               class="code sev- "><tt><i>161</i>             <span class="n">twist</span> <span class="o">=</span> <span class="n">twist</span><span class="p">[</span><span class="n">twist</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]]</span></tt>
            </div>
            <div id="l162"
               class="code sev- "><tt><i>162</i>             <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span></tt>
            </div>
            <div id="l163"
               class="code sev- "><tt><i>163</i>                 <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sequence</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span></tt>
            </div>
            <div id="l164"
               class="code sev- "><tt><i>164</i>                 <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">shift</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span></tt>
            </div>
            <div id="l165"
               class="code sev- "><tt><i>165</i>             <span class="p">]</span></tt>
            </div>
            <div id="l166"
               class="code sev- "><tt><i>166</i>             <span class="n">corr_index</span> <span class="o">=</span> <span class="p">[</span></tt>
            </div>
            <div id="l167"
               class="code sev- "><tt><i>167</i>                 <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sequence</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">shift</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span></tt>
            </div>
            <div id="l168"
               class="code sev- "><tt><i>168</i>             <span class="p">]</span></tt>
            </div>
            <div id="l169"
               class="code sev- "><tt><i>169</i>         <span class="k">else</span><span class="p">:</span></tt>
            </div>
            <div id="l170"
               class="code sev- "><tt><i>170</i>             <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sequence</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">seqpos</span><span class="p">]</span></tt>
            </div>
            <div id="l171"
               class="code sev- "><tt><i>171</i>             <span class="n">corr_index</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sequence</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">seqpos</span><span class="p">]</span></tt>
            </div>
            <div id="l172"
               class="code sev- "><tt><i>172</i> &nbsp;</tt>
            </div>
            <div id="l173"
               class="code sev- "><tt><i>173</i>         <span class="c1"># rename duplicated subunits</span></tt>
            </div>
            <div id="l174"
               class="code sev- "><tt><i>174</i>         <span class="n">shift</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">labels</span></tt>
            </div>
            <div id="l175"
               class="code sev- "><tt><i>175</i>         <span class="n">slide</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">labels</span></tt>
            </div>
            <div id="l176"
               class="code sev- "><tt><i>176</i>         <span class="n">rise</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">labels</span></tt>
            </div>
            <div id="l177"
               class="code sev- "><tt><i>177</i>         <span class="n">tilt</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">labels</span></tt>
            </div>
            <div id="l178"
               class="code sev- "><tt><i>178</i>         <span class="n">roll</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">labels</span></tt>
            </div>
            <div id="l179"
               class="code sev- "><tt><i>179</i>         <span class="n">twist</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">labels</span></tt>
            </div>
            <div id="l180"
               class="code sev- "><tt><i>180</i> &nbsp;</tt>
            </div>
            <div id="l181"
               class="code sev- "><tt><i>181</i>         <span class="c1"># set names to each dataset</span></tt>
            </div>
            <div id="l182"
               class="code sev- "><tt><i>182</i>         <span class="n">shift</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;shift&quot;</span></tt>
            </div>
            <div id="l183"
               class="code sev- "><tt><i>183</i>         <span class="n">slide</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;slide&quot;</span></tt>
            </div>
            <div id="l184"
               class="code sev- "><tt><i>184</i>         <span class="n">rise</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;rise&quot;</span></tt>
            </div>
            <div id="l185"
               class="code sev- "><tt><i>185</i>         <span class="n">tilt</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;tilt&quot;</span></tt>
            </div>
            <div id="l186"
               class="code sev- "><tt><i>186</i>         <span class="n">roll</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;roll&quot;</span></tt>
            </div>
            <div id="l187"
               class="code sev- "><tt><i>187</i>         <span class="n">twist</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;twist&quot;</span></tt>
            </div>
            <div id="l188"
               class="code sev- "><tt><i>188</i> &nbsp;</tt>
            </div>
            <div id="l189"
               class="code sev- "><tt><i>189</i>         <span class="c1"># get correlation between neighboring basepairs among all helical parameters</span></tt>
            </div>
            <div id="l190"
               class="code sev- "><tt><i>190</i>         <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span></tt>
            </div>
            <div id="l191"
               class="code sev- "><tt><i>191</i>         <span class="n">datasets</span> <span class="o">=</span> <span class="p">[</span><span class="n">shift</span><span class="p">,</span> <span class="n">slide</span><span class="p">,</span> <span class="n">rise</span><span class="p">,</span> <span class="n">tilt</span><span class="p">,</span> <span class="n">roll</span><span class="p">,</span> <span class="n">twist</span><span class="p">]</span></tt>
            </div>
            <div id="l192"
               class="code sev- "><tt><i>192</i>         <span class="k">for</span> <span class="n">ser1</span><span class="p">,</span> <span class="n">ser2</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="n">datasets</span><span class="p">):</span></tt>
            </div>
            <div id="l193"
               class="code sev- "><tt><i>193</i>             <span class="n">ser2_shifted</span> <span class="o">=</span> <span class="n">ser2</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></tt>
            </div>
            <div id="l194"
               class="code sev- "><tt><i>194</i>             <span class="n">ser2_shifted</span><span class="p">[</span><span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">ser2</span><span class="p">[</span><span class="n">labels</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span></tt>
            </div>
            <div id="l195"
               class="code sev- "><tt><i>195</i>             <span class="k">if</span> <span class="n">ser1</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">constants</span><span class="o">.</span><span class="n">hp_angular</span> <span class="ow">and</span> <span class="n">ser2</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">constants</span><span class="o">.</span><span class="n">hp_angular</span><span class="p">:</span></tt>
            </div>
            <div id="l196"
               class="code sev- "><tt><i>196</i>                 <span class="n">method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">circular</span></tt>
            </div>
            <div id="l197"
               class="code sev- "><tt><i>197</i>             <span class="k">elif</span> <span class="p">(</span></tt>
            </div>
            <div id="l198"
               class="code sev- "><tt><i>198</i>                 <span class="n">ser1</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">constants</span><span class="o">.</span><span class="n">hp_angular</span></tt>
            </div>
            <div id="l199"
               class="code sev-2  le">
               <ul class="violations">
               
                  <li>
                     <span class="count sev-2">
                        W503
                     </span>
                     Line break before binary operator</li>
               
               </ul><tt><i>199</i>                 <span class="ow">and</span> <span class="n">ser2</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">constants</span><span class="o">.</span><span class="n">hp_angular</span></tt>
            </div>
            <div id="l200"
               class="code sev- "><tt><i>200</i>             <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span></tt>
            </div>
            <div id="l201"
               class="code sev- "><tt><i>201</i>                 <span class="n">ser2</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">constants</span><span class="o">.</span><span class="n">hp_angular</span></tt>
            </div>
            <div id="l202"
               class="code sev-2  le">
               <ul class="violations">
               
                  <li>
                     <span class="count sev-2">
                        W503
                     </span>
                     Line break before binary operator</li>
               
               </ul><tt><i>202</i>                 <span class="ow">and</span> <span class="n">ser1</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">constants</span><span class="o">.</span><span class="n">hp_angular</span></tt>
            </div>
            <div id="l203"
               class="code sev- "><tt><i>203</i>             <span class="p">):</span></tt>
            </div>
            <div id="l204"
               class="code sev- "><tt><i>204</i>                 <span class="n">method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">circlineal</span></tt>
            </div>
            <div id="l205"
               class="code sev- "><tt><i>205</i>             <span class="k">else</span><span class="p">:</span></tt>
            </div>
            <div id="l206"
               class="code sev- "><tt><i>206</i>                 <span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;pearson&quot;</span>  <span class="c1"># type: ignore</span></tt>
            </div>
            <div id="l207"
               class="code sev- "><tt><i>207</i>             <span class="n">corr_data</span> <span class="o">=</span> <span class="n">ser1</span><span class="o">.</span><span class="n">corrwith</span><span class="p">(</span><span class="n">ser2_shifted</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span></tt>
            </div>
            <div id="l208"
               class="code sev- "><tt><i>208</i>             <span class="n">corr_data</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">corr_index</span></tt>
            </div>
            <div id="l209"
               class="code sev- "><tt><i>209</i>             <span class="n">results</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ser1</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">ser2</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">corr_data</span></tt>
            </div>
            <div id="l210"
               class="code sev- "><tt><i>210</i>         <span class="n">result_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">results</span><span class="p">)</span></tt>
            </div>
            <div id="l211"
               class="code sev- "><tt><i>211</i>         <span class="n">result_df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">corr_index</span>  <span class="c1"># type: ignore</span></tt>
            </div>
            <div id="l212"
               class="code sev- "><tt><i>212</i> &nbsp;</tt>
            </div>
            <div id="l213"
               class="code sev- "><tt><i>213</i>         <span class="c1"># save csv data</span></tt>
            </div>
            <div id="l214"
               class="code sev- "><tt><i>214</i>         <span class="n">result_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stage_io_dict</span><span class="p">[</span><span class="s2">&quot;out&quot;</span><span class="p">][</span><span class="s2">&quot;output_csv_path&quot;</span><span class="p">])</span></tt>
            </div>
            <div id="l215"
               class="code sev- "><tt><i>215</i> &nbsp;</tt>
            </div>
            <div id="l216"
               class="code sev- "><tt><i>216</i>         <span class="c1"># create heatmap</span></tt>
            </div>
            <div id="l217"
               class="code sev- "><tt><i>217</i>         <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;bwr&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></tt>
            </div>
            <div id="l218"
               class="code sev- "><tt><i>218</i>         <span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span></tt>
            </div>
            <div id="l219"
               class="code sev- "><tt><i>219</i>         <span class="n">num</span> <span class="o">=</span> <span class="n">cmap</span><span class="o">.</span><span class="n">N</span></tt>
            </div>
            <div id="l220"
               class="code sev- "><tt><i>220</i>         <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>  <span class="c1"># type: ignore</span></tt>
            </div>
            <div id="l221"
               class="code sev- "><tt><i>221</i>         <span class="n">cmap</span><span class="o">.</span><span class="n">set_bad</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;gainsboro&quot;</span><span class="p">)</span></tt>
            </div>
            <div id="l222"
               class="code sev- "><tt><i>222</i>         <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">7.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></tt>
            </div>
            <div id="l223"
               class="code sev- "><tt><i>223</i>         <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">result_df</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span></tt>
            </div>
            <div id="l224"
               class="code sev- "><tt><i>224</i>         <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span></tt>
            </div>
            <div id="l225"
               class="code sev- "><tt><i>225</i> &nbsp;</tt>
            </div>
            <div id="l226"
               class="code sev- "><tt><i>226</i>         <span class="c1"># axes</span></tt>
            </div>
            <div id="l227"
               class="code sev- "><tt><i>227</i>         <span class="n">xlocs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">result_df</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span></tt>
            </div>
            <div id="l228"
               class="code sev- "><tt><i>228</i>         <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">xlocs</span><span class="p">)</span></tt>
            </div>
            <div id="l229"
               class="code sev- "><tt><i>229</i>         <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">result_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span></tt>
            </div>
            <div id="l230"
               class="code sev- "><tt><i>230</i> &nbsp;</tt>
            </div>
            <div id="l231"
               class="code sev- "><tt><i>231</i>         <span class="n">ylocs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">result_df</span><span class="o">.</span><span class="n">index</span><span class="p">))</span></tt>
            </div>
            <div id="l232"
               class="code sev- "><tt><i>232</i>         <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">ylocs</span><span class="p">)</span></tt>
            </div>
            <div id="l233"
               class="code sev- "><tt><i>233</i>         <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">result_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>  <span class="c1"># type: ignore</span></tt>
            </div>
            <div id="l234"
               class="code sev- "><tt><i>234</i> &nbsp;</tt>
            </div>
            <div id="l235"
               class="code sev- "><tt><i>235</i>         <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span></tt>
            </div>
            <div id="l236"
               class="code sev- "><tt><i>236</i>             <span class="s2">&quot;Correlation for neighboring basepairs &quot;</span> <span class="s2">&quot;and pairs of helical parameters&quot;</span></tt>
            </div>
            <div id="l237"
               class="code sev- "><tt><i>237</i>         <span class="p">)</span></tt>
            </div>
            <div id="l238"
               class="code sev- "><tt><i>238</i> &nbsp;</tt>
            </div>
            <div id="l239"
               class="code sev- "><tt><i>239</i>         <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span></tt>
            </div>
            <div id="l240"
               class="code sev- "><tt><i>240</i>         <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stage_io_dict</span><span class="p">[</span><span class="s2">&quot;out&quot;</span><span class="p">][</span><span class="s2">&quot;output_jpg_path&quot;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;jpg&quot;</span><span class="p">)</span></tt>
            </div>
            <div id="l241"
               class="code sev- "><tt><i>241</i>         <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></tt>
            </div>
            <div id="l242"
               class="code sev- "><tt><i>242</i> &nbsp;</tt>
            </div>
            <div id="l243"
               class="code sev- "><tt><i>243</i>         <span class="c1"># Copy files to host</span></tt>
            </div>
            <div id="l244"
               class="code sev- "><tt><i>244</i>         <span class="bp">self</span><span class="o">.</span><span class="n">copy_to_host</span><span class="p">()</span></tt>
            </div>
            <div id="l245"
               class="code sev- "><tt><i>245</i> &nbsp;</tt>
            </div>
            <div id="l246"
               class="code sev- "><tt><i>246</i>         <span class="c1"># Remove temporary file(s)</span></tt>
            </div>
            <div id="l247"
               class="code sev- "><tt><i>247</i>         <span class="bp">self</span><span class="o">.</span><span class="n">tmp_files</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span></tt>
            </div>
            <div id="l248"
               class="code sev- "><tt><i>248</i>             <span class="p">[</span></tt>
            </div>
            <div id="l249"
               class="code sev- "><tt><i>249</i>                 <span class="bp">self</span><span class="o">.</span><span class="n">stage_io_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;unique_dir&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span></tt>
            </div>
            <div id="l250"
               class="code sev- "><tt><i>250</i>             <span class="p">]</span></tt>
            </div>
            <div id="l251"
               class="code sev- "><tt><i>251</i>         <span class="p">)</span></tt>
            </div>
            <div id="l252"
               class="code sev- "><tt><i>252</i>         <span class="bp">self</span><span class="o">.</span><span class="n">remove_tmp_files</span><span class="p">()</span></tt>
            </div>
            <div id="l253"
               class="code sev- "><tt><i>253</i> &nbsp;</tt>
            </div>
            <div id="l254"
               class="code sev- "><tt><i>254</i>         <span class="bp">self</span><span class="o">.</span><span class="n">check_arguments</span><span class="p">(</span><span class="n">output_files_created</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">raise_exception</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></tt>
            </div>
            <div id="l255"
               class="code sev- "><tt><i>255</i> &nbsp;</tt>
            </div>
            <div id="l256"
               class="code sev- "><tt><i>256</i>         <span class="k">return</span> <span class="mi">0</span></tt>
            </div>
            <div id="l257"
               class="code sev- "><tt><i>257</i> &nbsp;</tt>
            </div>
            <div id="l258"
               class="code sev- "><tt><i>258</i>     <span class="nd">@staticmethod</span></tt>
            </div>
            <div id="l259"
               class="code sev- "><tt><i>259</i>     <span class="k">def</span> <span class="nf">circular</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">):</span></tt>
            </div>
            <div id="l260"
               class="code sev- "><tt><i>260</i>         <span class="n">x1</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span></tt>
            </div>
            <div id="l261"
               class="code sev- "><tt><i>261</i>         <span class="n">x2</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span></tt>
            </div>
            <div id="l262"
               class="code sev- "><tt><i>262</i>         <span class="n">diff_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x1</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span></tt>
            </div>
            <div id="l263"
               class="code sev- "><tt><i>263</i>         <span class="n">diff_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x2</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span></tt>
            </div>
            <div id="l264"
               class="code sev- "><tt><i>264</i>         <span class="n">num</span> <span class="o">=</span> <span class="p">(</span><span class="n">diff_1</span> <span class="o">*</span> <span class="n">diff_2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span></tt>
            </div>
            <div id="l265"
               class="code sev- "><tt><i>265</i>         <span class="n">den</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">diff_1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="n">diff_2</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span></tt>
            </div>
            <div id="l266"
               class="code sev- "><tt><i>266</i>         <span class="k">return</span> <span class="n">num</span> <span class="o">/</span> <span class="n">den</span></tt>
            </div>
            <div id="l267"
               class="code sev- "><tt><i>267</i> &nbsp;</tt>
            </div>
            <div id="l268"
               class="code sev- "><tt><i>268</i>     <span class="nd">@staticmethod</span></tt>
            </div>
            <div id="l269"
               class="code sev- "><tt><i>269</i>     <span class="k">def</span> <span class="nf">circlineal</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">):</span></tt>
            </div>
            <div id="l270"
               class="code sev- "><tt><i>270</i>         <span class="n">x2</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span></tt>
            </div>
            <div id="l271"
               class="code sev- "><tt><i>271</i>         <span class="n">rc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x2</span><span class="p">))[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span></tt>
            </div>
            <div id="l272"
               class="code sev- "><tt><i>272</i>         <span class="n">rs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x2</span><span class="p">))[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span></tt>
            </div>
            <div id="l273"
               class="code sev- "><tt><i>273</i>         <span class="n">rcs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x2</span><span class="p">))[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span></tt>
            </div>
            <div id="l274"
               class="code sev- "><tt><i>274</i>         <span class="n">num</span> <span class="o">=</span> <span class="p">(</span><span class="n">rc</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">rs</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">rc</span> <span class="o">*</span> <span class="n">rs</span> <span class="o">*</span> <span class="n">rcs</span></tt>
            </div>
            <div id="l275"
               class="code sev- "><tt><i>275</i>         <span class="n">den</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">rcs</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span></tt>
            </div>
            <div id="l276"
               class="code sev- "><tt><i>276</i>         <span class="n">correlation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">num</span> <span class="o">/</span> <span class="n">den</span><span class="p">)</span></tt>
            </div>
            <div id="l277"
               class="code sev- "><tt><i>277</i>         <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">)[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span></tt>
            </div>
            <div id="l278"
               class="code sev- "><tt><i>278</i>             <span class="n">correlation</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span></tt>
            </div>
            <div id="l279"
               class="code sev- "><tt><i>279</i>         <span class="k">return</span> <span class="n">correlation</span></tt>
            </div>
            <div id="l280"
               class="code sev- "><tt><i>280</i> &nbsp;</tt>
            </div>
            <div id="l281"
               class="code sev- "><tt><i>281</i> &nbsp;</tt>
            </div>
            <div id="l282"
               class="code sev- "><tt><i>282</i> <span class="k">def</span> <span class="nf">interbpcorr</span><span class="p">(</span></tt>
            </div>
            <div id="l283"
               class="code sev- "><tt><i>283</i>     <span class="n">input_filename_shift</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span></tt>
            </div>
            <div id="l284"
               class="code sev- "><tt><i>284</i>     <span class="n">input_filename_slide</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span></tt>
            </div>
            <div id="l285"
               class="code sev- "><tt><i>285</i>     <span class="n">input_filename_rise</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span></tt>
            </div>
            <div id="l286"
               class="code sev- "><tt><i>286</i>     <span class="n">input_filename_tilt</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span></tt>
            </div>
            <div id="l287"
               class="code sev- "><tt><i>287</i>     <span class="n">input_filename_roll</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span></tt>
            </div>
            <div id="l288"
               class="code sev- "><tt><i>288</i>     <span class="n">input_filename_twist</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span></tt>
            </div>
            <div id="l289"
               class="code sev- "><tt><i>289</i>     <span class="n">output_csv_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span></tt>
            </div>
            <div id="l290"
               class="code sev- "><tt><i>290</i>     <span class="n">output_jpg_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span></tt>
            </div>
            <div id="l291"
               class="code sev- "><tt><i>291</i>     <span class="n">properties</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span></tt>
            </div>
            <div id="l292"
               class="code sev- "><tt><i>292</i>     <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span></tt>
            </div>
            <div id="l293"
               class="code sev- "><tt><i>293</i> <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span></tt>
            </div>
            <div id="l294"
               class="code sev- "><tt><i>294</i> <span class="w">    </span><span class="sd">&quot;&quot;&quot;Create :class:`HelParCorrelation &lt;correlations.interbpcorr.InterBasePairCorrelation&gt;` class and</span></tt>
            </div>
            <div id="l295"
               class="code sev- "><tt><i>295</i> <span class="sd">    execute the :meth:`launch() &lt;correlations.interbpcorr.InterBasePairCorrelation.launch&gt;` method.&quot;&quot;&quot;</span></tt>
            </div>
            <div id="l296"
               class="code sev- "><tt><i>296</i> &nbsp;</tt>
            </div>
            <div id="l297"
               class="code sev- "><tt><i>297</i>     <span class="k">return</span> <span class="n">InterBasePairCorrelation</span><span class="p">(</span></tt>
            </div>
            <div id="l298"
               class="code sev- "><tt><i>298</i>         <span class="n">input_filename_shift</span><span class="o">=</span><span class="n">input_filename_shift</span><span class="p">,</span></tt>
            </div>
            <div id="l299"
               class="code sev- "><tt><i>299</i>         <span class="n">input_filename_slide</span><span class="o">=</span><span class="n">input_filename_slide</span><span class="p">,</span></tt>
            </div>
            <div id="l300"
               class="code sev- "><tt><i>300</i>         <span class="n">input_filename_rise</span><span class="o">=</span><span class="n">input_filename_rise</span><span class="p">,</span></tt>
            </div>
            <div id="l301"
               class="code sev- "><tt><i>301</i>         <span class="n">input_filename_tilt</span><span class="o">=</span><span class="n">input_filename_tilt</span><span class="p">,</span></tt>
            </div>
            <div id="l302"
               class="code sev- "><tt><i>302</i>         <span class="n">input_filename_roll</span><span class="o">=</span><span class="n">input_filename_roll</span><span class="p">,</span></tt>
            </div>
            <div id="l303"
               class="code sev- "><tt><i>303</i>         <span class="n">input_filename_twist</span><span class="o">=</span><span class="n">input_filename_twist</span><span class="p">,</span></tt>
            </div>
            <div id="l304"
               class="code sev- "><tt><i>304</i>         <span class="n">output_csv_path</span><span class="o">=</span><span class="n">output_csv_path</span><span class="p">,</span></tt>
            </div>
            <div id="l305"
               class="code sev- "><tt><i>305</i>         <span class="n">output_jpg_path</span><span class="o">=</span><span class="n">output_jpg_path</span><span class="p">,</span></tt>
            </div>
            <div id="l306"
               class="code sev- "><tt><i>306</i>         <span class="n">properties</span><span class="o">=</span><span class="n">properties</span><span class="p">,</span></tt>
            </div>
            <div id="l307"
               class="code sev- "><tt><i>307</i>         <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span></tt>
            </div>
            <div id="l308"
               class="code sev- "><tt><i>308</i>     <span class="p">)</span><span class="o">.</span><span class="n">launch</span><span class="p">()</span></tt>
            </div>
            <div id="l309"
               class="code sev- "><tt><i>309</i> &nbsp;</tt>
            </div>
            <div id="l310"
               class="code sev- "><tt><i>310</i> &nbsp;</tt>
            </div>
            <div id="l311"
               class="code sev- "><tt><i>311</i> <span class="k">def</span> <span class="nf">main</span><span class="p">():</span></tt>
            </div>
            <div id="l312"
               class="code sev- "><tt><i>312</i> <span class="w">    </span><span class="sd">&quot;&quot;&quot;Command line execution of this building block. Please check the command line documentation.&quot;&quot;&quot;</span></tt>
            </div>
            <div id="l313"
               class="code sev- "><tt><i>313</i>     <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span></tt>
            </div>
            <div id="l314"
               class="code sev- "><tt><i>314</i>         <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Load .ser file from Canal output and calculate correlation between base pairs of the corresponding sequence.&quot;</span><span class="p">,</span></tt>
            </div>
            <div id="l315"
               class="code sev- "><tt><i>315</i>         <span class="n">formatter_class</span><span class="o">=</span><span class="k">lambda</span> <span class="n">prog</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">RawTextHelpFormatter</span><span class="p">(</span><span class="n">prog</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">99999</span><span class="p">),</span></tt>
            </div>
            <div id="l316"
               class="code sev- "><tt><i>316</i>     <span class="p">)</span></tt>
            </div>
            <div id="l317"
               class="code sev- "><tt><i>317</i>     <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--config&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Configuration file&quot;</span><span class="p">)</span></tt>
            </div>
            <div id="l318"
               class="code sev- "><tt><i>318</i> &nbsp;</tt>
            </div>
            <div id="l319"
               class="code sev- "><tt><i>319</i>     <span class="n">required_args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_argument_group</span><span class="p">(</span><span class="s2">&quot;required arguments&quot;</span><span class="p">)</span></tt>
            </div>
            <div id="l320"
               class="code sev- "><tt><i>320</i>     <span class="n">required_args</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span></tt>
            </div>
            <div id="l321"
               class="code sev- "><tt><i>321</i>         <span class="s2">&quot;--input_filename_shift&quot;</span><span class="p">,</span></tt>
            </div>
            <div id="l322"
               class="code sev- "><tt><i>322</i>         <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span></tt>
            </div>
            <div id="l323"
               class="code sev- "><tt><i>323</i>         <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Path to ser file for helical parameter shift. Accepted formats: ser.&quot;</span><span class="p">,</span></tt>
            </div>
            <div id="l324"
               class="code sev- "><tt><i>324</i>     <span class="p">)</span></tt>
            </div>
            <div id="l325"
               class="code sev- "><tt><i>325</i>     <span class="n">required_args</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span></tt>
            </div>
            <div id="l326"
               class="code sev- "><tt><i>326</i>         <span class="s2">&quot;--input_filename_slide&quot;</span><span class="p">,</span></tt>
            </div>
            <div id="l327"
               class="code sev- "><tt><i>327</i>         <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span></tt>
            </div>
            <div id="l328"
               class="code sev- "><tt><i>328</i>         <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Path to ser file for helical parameter slide. Accepted formats: ser.&quot;</span><span class="p">,</span></tt>
            </div>
            <div id="l329"
               class="code sev- "><tt><i>329</i>     <span class="p">)</span></tt>
            </div>
            <div id="l330"
               class="code sev- "><tt><i>330</i>     <span class="n">required_args</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span></tt>
            </div>
            <div id="l331"
               class="code sev- "><tt><i>331</i>         <span class="s2">&quot;--input_filename_rise&quot;</span><span class="p">,</span></tt>
            </div>
            <div id="l332"
               class="code sev- "><tt><i>332</i>         <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span></tt>
            </div>
            <div id="l333"
               class="code sev- "><tt><i>333</i>         <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Path to ser file for helical parameter rise. Accepted formats: ser.&quot;</span><span class="p">,</span></tt>
            </div>
            <div id="l334"
               class="code sev- "><tt><i>334</i>     <span class="p">)</span></tt>
            </div>
            <div id="l335"
               class="code sev- "><tt><i>335</i>     <span class="n">required_args</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span></tt>
            </div>
            <div id="l336"
               class="code sev- "><tt><i>336</i>         <span class="s2">&quot;--input_filename_tilt&quot;</span><span class="p">,</span></tt>
            </div>
            <div id="l337"
               class="code sev- "><tt><i>337</i>         <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span></tt>
            </div>
            <div id="l338"
               class="code sev- "><tt><i>338</i>         <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Path to ser file for helical parameter tilt. Accepted formats: ser.&quot;</span><span class="p">,</span></tt>
            </div>
            <div id="l339"
               class="code sev- "><tt><i>339</i>     <span class="p">)</span></tt>
            </div>
            <div id="l340"
               class="code sev- "><tt><i>340</i>     <span class="n">required_args</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span></tt>
            </div>
            <div id="l341"
               class="code sev- "><tt><i>341</i>         <span class="s2">&quot;--input_filename_roll&quot;</span><span class="p">,</span></tt>
            </div>
            <div id="l342"
               class="code sev- "><tt><i>342</i>         <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span></tt>
            </div>
            <div id="l343"
               class="code sev- "><tt><i>343</i>         <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Path to ser file for helical parameter roll. Accepted formats: ser.&quot;</span><span class="p">,</span></tt>
            </div>
            <div id="l344"
               class="code sev- "><tt><i>344</i>     <span class="p">)</span></tt>
            </div>
            <div id="l345"
               class="code sev- "><tt><i>345</i>     <span class="n">required_args</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span></tt>
            </div>
            <div id="l346"
               class="code sev- "><tt><i>346</i>         <span class="s2">&quot;--input_filename_twist&quot;</span><span class="p">,</span></tt>
            </div>
            <div id="l347"
               class="code sev- "><tt><i>347</i>         <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span></tt>
            </div>
            <div id="l348"
               class="code sev- "><tt><i>348</i>         <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Path to ser file for helical parameter twist. Accepted formats: ser.&quot;</span><span class="p">,</span></tt>
            </div>
            <div id="l349"
               class="code sev- "><tt><i>349</i>     <span class="p">)</span></tt>
            </div>
            <div id="l350"
               class="code sev- "><tt><i>350</i>     <span class="n">required_args</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span></tt>
            </div>
            <div id="l351"
               class="code sev- "><tt><i>351</i>         <span class="s2">&quot;--output_csv_path&quot;</span><span class="p">,</span></tt>
            </div>
            <div id="l352"
               class="code sev- "><tt><i>352</i>         <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span></tt>
            </div>
            <div id="l353"
               class="code sev- "><tt><i>353</i>         <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Path to output file. Accepted formats: csv.&quot;</span><span class="p">,</span></tt>
            </div>
            <div id="l354"
               class="code sev- "><tt><i>354</i>     <span class="p">)</span></tt>
            </div>
            <div id="l355"
               class="code sev- "><tt><i>355</i>     <span class="n">required_args</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span></tt>
            </div>
            <div id="l356"
               class="code sev- "><tt><i>356</i>         <span class="s2">&quot;--output_jpg_path&quot;</span><span class="p">,</span></tt>
            </div>
            <div id="l357"
               class="code sev- "><tt><i>357</i>         <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span></tt>
            </div>
            <div id="l358"
               class="code sev- "><tt><i>358</i>         <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Path to output plot. Accepted formats: jpg.&quot;</span><span class="p">,</span></tt>
            </div>
            <div id="l359"
               class="code sev- "><tt><i>359</i>     <span class="p">)</span></tt>
            </div>
            <div id="l360"
               class="code sev- "><tt><i>360</i> &nbsp;</tt>
            </div>
            <div id="l361"
               class="code sev- "><tt><i>361</i>     <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span></tt>
            </div>
            <div id="l362"
               class="code sev- "><tt><i>362</i>     <span class="n">args</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">config</span> <span class="ow">or</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span></tt>
            </div>
            <div id="l363"
               class="code sev- "><tt><i>363</i>     <span class="n">properties</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">ConfReader</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">config</span><span class="p">)</span><span class="o">.</span><span class="n">get_prop_dic</span><span class="p">()</span></tt>
            </div>
            <div id="l364"
               class="code sev- "><tt><i>364</i> &nbsp;</tt>
            </div>
            <div id="l365"
               class="code sev- "><tt><i>365</i>     <span class="n">interbpcorr</span><span class="p">(</span></tt>
            </div>
            <div id="l366"
               class="code sev- "><tt><i>366</i>         <span class="n">input_filename_shift</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">input_filename_shift</span><span class="p">,</span></tt>
            </div>
            <div id="l367"
               class="code sev- "><tt><i>367</i>         <span class="n">input_filename_slide</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">input_filename_slide</span><span class="p">,</span></tt>
            </div>
            <div id="l368"
               class="code sev- "><tt><i>368</i>         <span class="n">input_filename_rise</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">input_filename_rise</span><span class="p">,</span></tt>
            </div>
            <div id="l369"
               class="code sev- "><tt><i>369</i>         <span class="n">input_filename_tilt</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">input_filename_tilt</span><span class="p">,</span></tt>
            </div>
            <div id="l370"
               class="code sev- "><tt><i>370</i>         <span class="n">input_filename_roll</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">input_filename_roll</span><span class="p">,</span></tt>
            </div>
            <div id="l371"
               class="code sev- "><tt><i>371</i>         <span class="n">input_filename_twist</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">input_filename_twist</span><span class="p">,</span></tt>
            </div>
            <div id="l372"
               class="code sev- "><tt><i>372</i>         <span class="n">output_csv_path</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">output_csv_path</span><span class="p">,</span></tt>
            </div>
            <div id="l373"
               class="code sev- "><tt><i>373</i>         <span class="n">output_jpg_path</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">output_jpg_path</span><span class="p">,</span></tt>
            </div>
            <div id="l374"
               class="code sev- "><tt><i>374</i>         <span class="n">properties</span><span class="o">=</span><span class="n">properties</span><span class="p">,</span></tt>
            </div>
            <div id="l375"
               class="code sev- "><tt><i>375</i>     <span class="p">)</span></tt>
            </div>
            <div id="l376"
               class="code sev- "><tt><i>376</i> &nbsp;</tt>
            </div>
            <div id="l377"
               class="code sev- "><tt><i>377</i> &nbsp;</tt>
            </div>
            <div id="l378"
               class="code sev- "><tt><i>378</i> <span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span></tt>
            </div>
            <div id="l379"
               class="code sev- "><tt><i>379</i>     <span class="n">main</span><span class="p">()</span></tt>
            </div>
            
         </div>
      </div>
   </body>
</html>